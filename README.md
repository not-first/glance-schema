# Glance Schema
*A JSON schema detailing the [Glance](https://github.com/glanceapp/glance) config file.*

> [!NOTE]
> Currently represents version: v0.8.4. Now supports validation of split config files using [`$include`](https://github.com/glanceapp/glance/blob/main/docs/configuration.md?tab=readme-ov-file#including-other-config-files)!

> [!WARNING]
> Although split config files can now be validated using the new exposed definitions, full schema support for $include is still being ironed out. Expect some errors here and there, even though your config file may be correct!

## Usage
The schema is available at: `https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json`

### Main Config File (glance.yml)

For your main `glance.yml` configuration file:

1. Install the [YAML extension](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml) for VS Code.
2. At the top of your `glance.yml` file, add this line:
   ```yaml
   # yaml-language-server: $schema=https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json
   ```
3. Done! You'll now get typing completions, hover descriptions, and validation errors.

### Split Config Files

The schema now supports validating split config files using the `$include` directive. Here are examples for common use cases:

#### Widget Files

Widget files should **always be arrays**, even for a single widget (this is the official Glance recommendation):

```yaml
# yaml-language-server: $schema=https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json#/definitions/widget

- type: weather
  location: New York, United States
```

For multiple widgets in one file:

```yaml
# yaml-language-server: $schema=https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json#/definitions/widget

- type: rss
  title: Tech News
  feeds:
    - url: https://example.com/tech/feed

- type: rss
  title: World News
  feeds:
    - url: https://example.com/world/feed
```

#### Page Files

Page files should be **single page objects** (NOT arrays):

```yaml
# yaml-language-server: $schema=https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json#/definitions/page

name: Home
columns:
  - size: full
    widgets:
      - type: rss
        title: News
```

#### Using $include in Your Main Config

Example `glance.yml` with includes:

```yaml
# yaml-language-server: $schema=https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json

server:
  port: 8080

pages:
  - $include: pages/home.yml      # Single page object
  - $include: pages/dashboard.yml # Single page object
  - name: Inline Page
    columns:
      - size: full
        widgets:
          $include: widgets/weather.yml  # Widget array (even if 1 item)
          $include: widgets/rss.yml      # Widget array
          - type: clock                  # Inline widget
```

### Automatic Schema Application for Folders

For projects with dedicated folders for widgets and pages, you can configure VS Code to automatically apply the appropriate schema without adding comments to each file.

Add this to your `.vscode/settings.json`:

```json
{
  "yaml.schemas": {
    "https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json": ["glance.yml"],
    "https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json#/definitions/widget": ["widgets/*.yml"],
    "https://raw.githubusercontent.com/not-first/glance-schema/master/schema.json#/definitions/page": ["pages/*.yml"]
  }
}
```

This configuration:
- Applies the main schema to `glance.yml`
- Applies the widget schema (array) to all `.yml` files in the `widgets/` folder
- Applies the page schema (single object) to all `.yml` files in the `pages/` folder


## Known Limitations
Some error messages can be autogenerated by the schema validator and are unhelpful in figuring out what is wrong. These can be customised in the schema once they are located, so please create an issue if you experience one.

